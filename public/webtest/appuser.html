<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="css/pure-min.css">
<title>carnation webtest appuser</title>
</head>
<body>
  <h1>appuser test</h1>
    <p>
      user_id: <span id="user_id"></span><br/>
      token: <span id="token"></span><br/>
      scope: <span id="scope"></span><br/>
      token_type: <span id="token_type"></span><br/>
      valid until: <span id="valid_until"></span>
      <input type="button" value="reset" onclick="reset_token()"><br/>
    </p>
    <form class="get_user_token" action="/token" method="post">
      email:<input type="text" value="test01@chikaku.com" name="email" size="20"/>
      password:<input type="text" value="dx7PnxqDZ5kr" name="password" size="15"/>
      <input type="submit" value="retrieve access token"><p id="description"/>
    </form>

    <form action="result.html" method="get" target="result">
      <input type="submit" value="open result window"/>
    </form>

    <hr/><h4>initiate item upload</h4>
    <form class="carnation_api" action="/api/v1/item/initiate" method="post" id="upload">
      user_id:<input type="text" name="user_id" size="5"/>
      item_id:<input type="text" name="item_id" size="5"/>
      name:<input type="text" name="name" size="10"/>
      width:<input type="number" name="width" size="10"/>
      height:<input type="number" name="height" size="10"/>
      extension:<select name="extension">
        <option value=".jpg">.jpg</option>
        <option value=".png">.png</option>
        <option value=".mp4">.mp4</option>
      </select>
      <input type="reset" value="reset"><br/>
      <input type="submit" value="send"><br/>
      <p id="description"/>
    </form>

    <hr/><h4>initiate item upload with browser (test purpose only) </h4>
    <form action="/api/v1/item/initiate_post" method="post" target="upload">
      user_id:<input type="text" name="user_id" size="5"/>
      item_id:<input type="text" name="item_id" size="5"/>
      name:<input type="text" name="name" size="10"/>
      width:<input type="number" name="width" size="10"/>
      height:<input type="number" name="height" size="10"/>
      extension:<select name="extension">
        <option value=".jpg">.jpg</option>
        <option value=".png">.png</option>
        <option value=".mp4">.mp4</option>
      </select>
      <input type="reset" value="reset"><br/>
      <input type="submit" value="send"><br/>
    </form>

    <hr/><h4>notify_uploaded</h4>
    <form class="carnation_api" action="/api/v1/item/uploaded" method="put">
      user_id:<input type="text" name="user_id" size="5"/>
      item_id:<input type="text" name="item_id" size="5"/>
      valid_after:<input type="text" name="valid_after" size="5"/>
      <input type="reset" value="reset"><br/><input type="submit" value="send"><p id="description"/>
    </form>

    <hr/><h4>get_user_images</h4>
    <form class="carnation_api" action="/api/v1/user/images" method="get">
      user_id:<input type="text" name="user_id" size="5"/>
      item_id:<input type="text" name="item_id" size="5"/>
      count:<input type="number" name="count" size="2"/>
      greater_than:<input type="number" name="greater_than" size="1"/>
      less_than:<input type="number" name="less_than" size="1"/>
      created_after:<input type="number" name="created_after" size="1"/>
      created_before:<input type="number" name="created_before" size="1"/>
      offset:<input type="number" name="offset" size="1"/>
      <input type="reset" value="reset"><br/><input type="submit" value="send"><p id="description"/>
    </form>

  <script src="js/jquery-2.1.0.js"></script>
  <script src="js/carnation.js"></script>
  <script>

    var reset_token = function() {
      console.log("reset_token called!!!!!");
      carnation.reset_appuser_token();
    }

    $(".get_user_token").submit( function (event) {
      console.log( "get user token" );
      event.preventDefault();
      email = $(this).find('*[name=email]')[0].value;
      password = $(this).find('*[name=password]')[0].value;
      carnation.get_appuser_token(email, password, function(token) {
        carnation.show_token(token);
        $('*[name="user_id"]').val(token.user_id);
      });
    });
  </script>
</body>
</html>
